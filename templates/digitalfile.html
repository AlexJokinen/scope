{% extends 'base.html' %}

{% load custom_tags %}
{% load i18n %}

{% block title %}
{% blocktrans %}Digital file {{ digitalfile }}{% endblocktrans %}
{% endblock %}

{% block content %}
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="{% url 'collections' %}">{% trans "Collections" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'collection' digitalfile.dip.collection.pk %}">{{ digitalfile.dip.collection }}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'dip' digitalfile.dip.pk %}">{{ digitalfile.dip }}</a></li>
    <li class="breadcrumb-item active">{{ digitalfile.uuid }}</li>
  </ol>
  <div class="row">
    <div class="col-md-7">
      <h2 class="mb-3">{% trans "Digital file description" %}</h2>
      <p><strong>{% trans "UUID" %}:</strong> {{ digitalfile.uuid }}</p>
      <p><strong>{% trans "Filepath" %}:</strong> {{ digitalfile.filepath }}</p>
      <p><strong>{% trans "File format" %}:</strong> {{ digitalfile.fileformat }}</p>
      <p><strong>{% trans "File format version" %}:</strong> {{ digitalfile.formatversion }}</p>
      <p><strong>{% trans "Size (bytes)" %}:</strong> {{ digitalfile.size_bytes }}</p>
      <p><strong>{% trans "Size (human readable)" %}:</strong> {{ digitalfile.size_human }}</p>
      <p><strong>{% trans "Date modified" %}:</strong> {{ digitalfile.datemodified|default:"" }}</p>
      <p><strong>{% trans "PRONOM ID" %}:</strong> <a href="http://nationalarchives.gov.uk/PRONOM/{{digitalfile.puid}}">{{ digitalfile.puid }}</a></p>
      <p><strong>{% trans "METS amdSec" %}:</strong> {{ digitalfile.amdsec }}</p>
      <p><strong>{% blocktrans %}Checksum ({{ digitalfile.hashtype }}){% endblocktrans %}:</strong> {{ digitalfile.hashvalue }}</p>
    </div>
    <div class="col-md-5 my-3 my-md-0">
      <h2 class="mb-3">{% trans "Attachments" %}</h2>
      <div class="card">
        <div class="card-body p-3">
          <p><strong>{% trans "Digital files" %}:</strong> {{ digitalfile.dip.objectszip.name }}</p>
          <p>{% trans "By clicking on the button below you'll download all the digital files included in the same folder." %}</p>
          <a href="{% url 'download_dip' digitalfile.dip.pk %}" class="btn btn-primary d-inline-block">{% trans "Download zip file" %}</a>
        </div>
      </div>
    </div>
  </div>
  <div class="card mt-4">
    <div class="card-header">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed pl-0" type="button" data-toggle="collapse" data-target="#collapsed-premis" aria-expanded="false" aria-controls="collapsed-premis">
          {% trans "Preservation metadata" %}
        </button>
      </h5>
    </div>
    <div class="collapse" id="collapsed-premis">
      <div class="card-body">
        <p><em>{% trans "Event log from our digital preservation repository for this file." %}</em></p>
        {% for event in digitalfile.premis_events.all|sort_by:'datetime' %}
          <h4 class="mt-4">{% blocktrans %}Event: {{ event.uuid }}{% endblocktrans %}</h4>
          <p><strong>{% trans "Event type" %}:</strong> {{ event.eventtype }}</p>
          <p><strong>{% trans "Datetime" %}:</strong> {{ event.datetime }}</p>
          <p><strong>{% trans "Event detail" %}:</strong> {{ event.detail }}</p>
          <p><strong>{% trans "Event outcome" %}:</strong> {{ event.outcome }}</p>
          <p><strong>{% trans "Event detail note" %}:</strong> {{ event.detailnote }}</p>
        {% endfor %}
      </div>
    </div>
  </div>
{% endblock %}
